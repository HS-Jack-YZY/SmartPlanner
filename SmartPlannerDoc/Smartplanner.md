# Smartplanner

## 设计初衷
我计划设计的app来自于一个启发，即如果我是一个公司的老板，我非常支持员工居家办公而不需要通勤到达公司上班。但是有一个难题是：我如何让员工在家中的效率一样高或者更高；我如何知道员工居家办公是否能完成和在公司工作一样或更多的工作。
因此我想设计一个app：
1: 用户可以在这个app中设置明天的工作计划（或者一个周期性的计划）。在第二天开始工作的时候，app会提醒你即将或现在的计划是什么，用户需要手动开始、结束该计划（比如，设置8:00-9:00背单词，用户于8:03在app上点击开始这个计划，那么app记录开始时间是8:03。用户于8:47在app上结束了该计划，app记录结束时间是8:47），app通过记录、学习用户的这个周期计划，重新安排之后这个周期计划的起止时间，以达到用户稳定、高效的生活规律。不仅如此，用户还可以填写其他信息，如 是否在结束时完成计划、是否因为突发事件提前或延后开始或结束时间 等 有助于app进行学习的信息。
2: 用户可以给计划添加标签，如 添加计划的难易程度（低、中、高），往往低难度的任务可以在指定时间完成，高难度的任务可能无法在指定时间完成，会被延长到其他时间段完成（可能是压缩后续计划的时间，也可能是把所有后续计划往后挪动，或是将今天未完成的计划移动未来完成）；添加该计划的紧急程度；添加该计划是否需要很强的脑力劳动，如记忆；该计划是运动、娱乐、还是工作。这些标签的组合协助app规划用户未来的行程和计划，协助用户尽量完成任务。
3: 统计用户的有效工作时间，计算工作效率等。协调用户的工作与休闲平衡。
本来，这个app的用户群体是公司的员工和老板，帮助老板关注员工不在公司的工作状态和效率。但我发现，这个app适合所有希望有规律作息和高效率办公要求的人。app很像一个用户的私人秘书，为用户根据app学习到的用户偏好规划好未来的所有工作和行程，如果行程有变化，也能同步修改之后的工作实现效率最大化。
## 1. 核心功能模块

### 1.1 日历视图
- **视图切换**
  - 日视图
    - 24小时时间轴
    - 15分钟时间刻度
    - 当前时间指示
    - 可用时间段背景色标识
  
  - 周视图
    - 七天并列显示
    - 可左右滑动切换周
    - 工作日/周末差异化显示
    - 当天高亮显示

  - 月视图
    - 传统日历格式
    - 日期格子内显示计划预览
    - 节假日标识
    - 可上下滑动切换月份

- **交互功能**
  - 拖放操作
    - 从计划模板拖入具体时间段
    - 计划实例时间调整
    - 跨天拖动
    - 智能吸附对齐
  
  - 手势操作
    - 双指缩放调整时间跨度
    - 左右滑动切换日期
    - 长按创建新计划
    - 点击查看计划详情

- **显示功能**
  - 计划显示
    - 根据时长自动调整高度
    - 显示计划基本信息
    - 标签颜色标识
    - 完成状态标识
  
  - 时间冲突显示
    - 视觉冲突提示
    - 重叠计划处理
    - 超出可用时间提示

  - 自定义显示
    - 可选择显示/隐藏特定标签的计划
    - 自定义计划显示密度
    - 自定义颜色主题

### 1.2 计划区间模版
- **区间属性**
  - id: 区间ID
  - name: 区间名称
  - color: 区间颜色
  - description: 区间描述
  - isVisible: 是否在日历中显示该类型区间
  - createdAt: 创建时间
  - updatedAt: 最后更新时间
  - deletedAt: 删除时间（用于软删除）

- **区间特性**
  - 可拖拽至日历视图
  - 作为计划容器管理其内部计划
    - 基于用户习惯的时间自适应
    - 重复性计划的动态时间优化
    - 未完成计划自动顺延至下一区间
    
### 1.3 计划区间实例
- **实例属性**
  - 基础信息
    - id: 实例ID
    - templateID: 关联的模版ID
  - 时间信息
    - startAt: 开始时间
    - endAt: 结束时间
    - createdAt: 创建时间
    - updatedAt: 最后修改时间
    - deletedAt: 删除时间（用于软删除）
  - 重复信息
    - recurrenceType: 重复类型（每天/每周/每月）
    - recurrenceInterval: 重复间隔
    - recurrenceDays: 每周重复的星期（如[1,2,3,4,5]表示周一到周五）
    - recurrenceStartDate: 重复开始日期
    - recurrenceEndDate: 重复结束日期（可选）
    - recurrenceCount: 重复次数（可选）
  - 统计信息
    - totalPlannedTime: 计划总时长
    - totalActualTime: 实际总用时
    - interruptions: 中断记录列表
    - interruptionCount: 中断次数
  - 关联信息
    - containedPlanIds: 包含的具体计划ID列表
  
- **实例行为**
  - 状态转换
    - 开始执行
    - 暂停执行
    - 标记完成
    - 取消执行
  - 计划管理
    - 添加计划
    - 移除计划
    - 调整计划顺序
    - 更新计划状态
  - 数据统计
    - 计算实际执行时长
    - 统计计划完成情况
    - 分析执行效率
    - 生成执行报告

- **智能特性**
  - 自动优化
    - 基于历史数据的时间预估
    - 动态调整计划顺序
    - 智能处理计划冲突
    - 优化计划间隔时间
  
  - 学习机制
    - 记录用户执行模式
    - 学习最佳执行时间
    - 适应用户习惯变化
    - 提供个性化建议

### 1.4 计划模版
#### 1.4.1 新增计划界面
- **入口**
  - 位置：主界面右下角悬浮按钮（FAB，Floating Action Button）
  - 样式：圆形加号图标
  - 点击动效：弹出新增计划表单

- **表单字段**
  - 基础信息
    - id：模版唯一标识符
    - name：计划名称（如"雅思阅读"）
    - categoryId：所属类别ID
    - color：显示颜色（继承自类别）
  - 计划属性
    - isFixedTime：是否固定时间（false表示AI可调整）
    - isReminderEnabled：是否启用提醒
    - reminderTime：提醒提前时间（分钟）
    - priority：优先级（用于AI调整时的参考）
    - difficulty：难度等级
    - tags：标签列表
  - 时间戳
    - createdAt：创建时间
    - updatedAt：更新时间
    - deletedAt：删除时间
    
- **操作按钮**
  - 保存按钮
    - 位置：表单底部
    - 验证：检查必填项
    - 响应：保存成功后返回主界面
  
  - 取消按钮
    - 位置：表单底部或顶部返回箭头
    - 响应：放弃当前编辑并返回

- **交互逻辑**
  - 表单验证
    - 实时验证：输入时进行字段验证
    - 提交验证：保存时进行完整性检查
    
  - 时间冲突检查
    - 检查是否与已有计划时间冲突
    - 提供冲突解决建议
    
  - 数据存储
    - 本地存储：计划基本信息
    - 云端同步：支持多设备数据同步

- **计划执行**
  - 开始/暂停/结束按钮
  - 实时计时器
  - 计划完成度记录
  - 中断原因记录
  - **计划溢出处理策略**
    - 压缩模式：压缩后续计划时长
    - 顺延模式：整体后移所有计划
    - 转移模式：将未完成计划转移至其他日期
    - 混合模式：根据计划优先级智能调整

### 1.5 计划实例
- **实例创建**
  - 从计划模板拖拽创建
  - 继承模板基本属性
  - 自动分配实例ID
  - 记录创建时间和创建方式

- **实例属性**
  - 基础信息
    - id：实例唯一标识符
    - templateId：关联的计划模版ID
    - blockId：所属区间实例ID
    - name：计划名称（继承自模版）
    - categoryId：所属类别ID（继承自模版）
  - 时间信息
    - startTime：开始时间
    - endTime：结束时间
    - duration：持续时长
    - reminderTime：提醒提前时间（可覆盖模版设置）
  - 重复规则
    - recurrenceType：重复类型
    - recurrenceInterval：重复间隔
    - recurrenceDays：重复日期
    - recurrenceStartDate：重复开始日期
    - recurrenceEndDate：重复结束日期
    - recurrenceCount：重复次数
  - 状态信息
    - actualStartTime：实际开始时间
    - actualEndTime：实际结束时间
    - completionRate：完成度
    - efficiency：执行效率评分
  - 时间戳
    - createdAt：创建时间
    - updatedAt：更新时间
    - deletedAt：删除时间

- **实例操作**
  - 时间调整
    - 拖拽改变时间
    - 修改持续时长
    - 跨天移动
  
  - 状态管理
    - 开始执行
    - 暂停执行
    - 继续执行
    - 完成计划
    - 取消计划
  
  - 数据记录
    - 实际开始时间
    - 实际结束时间
    - 中断记录
    - 完成情况
    - 执行笔记

- **实例同步**
  - 本地存储
  - 云端备份
  - 多设备同步
  - 离线支持

### 1.6 智能分析系统
- **数据收集**
  - 计划执行时长
  - 计划延迟/提前情况
  - 完成度统计
  - 中断原因分析

- **AI 优化建议**
  - 个性化时间段推荐
  - 计划顺序优化
  - 工作效率分析
  - 休息时间建议

### 1.7 类别
- **基础信息**
  - id：类别唯一标识符
  - name：类别名称（如"英语"）
  - color：显示颜色（如蓝色）
  - parentId：父类别ID（可选，用于构建类别层级）
  - level：层级深度（0表示顶级类别）
  - path：类别完整路径（如 "学习/英语/雅思"）
- **显示相关**
  - isVisible：是否在界面中显示
  - displayOrder：显示顺序
- **时间戳**
  - createdAt：创建时间
  - updatedAt：更新时间
  - deletedAt：删除时间

## 2. 界面设计

### 2.1 主界面
- 今日计划时间轴
- 实时进行中的任务
- 快速添加按钮
- 效率统计概览

### 2.2 计划详情页
- 计划基本信息
- 执行记录
- 完成情况
- 调整建议

### 2.3 数据分析页
- 工作效率趋势图
- 计划完成率统计
- 时间分配分析
- 工作习惯报告

## 3. 智能特性

### 3.1 自适应计划调整
- 根据历史数据自动调整计划时长
- 智能识别最佳工作时段
- 动态调整任务优先级
- 自动处理计划冲突

### 3.2 个性化建议
- 工作效率提升建议
- 休息时间优化
- 工作专注度建议
- 生活作息平衡建议

## 4. 企业版特性

### 4.1 团队管理功能
- 团队效能分析
- 工作量均衡建议
- 团队协作优化
- 远程工作监控

### 4.2 报告系统
- 个人效能报告
- 团队效能报告
- 项目进度追踪
- 工作质量评估

## 5. 隐私保护

- 数据加密存储
- 隐私设置选项
- 数据访问权限控制
- 敏感信息保护

## 6. 扩展功能

- 日历同步
- 待办事项导入
- 第三方工具集成
- 智能语音助手

## 7. 使用说明

### 7.1 基础使用流程
- **创建计划**
  - 创建计划模板
  - 将计划拖拽到日历视图的具体时间段
  - 设置计划的重复规则（可选）
  - 设置提醒方式（可选）

- **执行计划**
  - 收到计划开始提醒
  - 手动点击"开始"按钮记录实际开始时间
  - 执行计划内容
  - 完成后点击"结束"按钮记录实际结束时间
  - 填写执行反馈（完成度、中断原因等）

### 7.2 计划标签使用
- **难度等级标签**
  - 低难度：通常能在预定时间内完成
  - 中等难度：完成时间可能有少量浮动
  - 高难度：完成时间不确定性较大，系统会预留缓冲时间

- **紧急程度标签**
  - 用于标记任务优先级
  - 影响计划冲突时的自动调整策略
  - 决定提醒频率和强度

- **任务类型标签**
  - 脑力密集型：需要高度专注
  - 体力型：运动或体力活动
  - 例行工作：日常重复性工作
  - 创意工作：需要创造性思维

### 7.3 智能调整机制
- **计划延期处理**
  - 压缩后续计划时间
  - 整体后移所有计划
  - 将计划转移至其他日期
  - 系统根据计划标签自动选择最优方案

- **学习与优化**
  - 记录用户实际执行情况
  - 学习用户工作习惯
  - 优化未来计划时间安排
  - 提供个性化建议

### 7.4 效率统计
- **时间统计**
  - 记录实际工作时长
  - 统计各类型任务时间占比
  - 分析工作效率趋势
  - 生成工作报告

- **平衡建议**
  - 工作与休息时间配比
  - 高强度工作预警
  - 休息时间建议
  - 工作效率优化建议

### 7.5 企业协作
- **员工使用**
  - 记录个人工作计划
  - 追踪工作完成情况
  - 获取个性化工作建议
  - 保持工作生活平衡

- **管理者功能**
  - 查看团队工作概况
  - 分析团队效能数据
  - 识别效率提升机会
  - 优化团队工作安排

## 8. 技术架构

### 8.1 前端（iOS App）职责
- **用户界面**
  - 日历视图实现
  - 计划拖拽交互
  - 表单界面
  - 数据可视化图表
  - 动画效果

- **本地数据管理**
  - SQLite/Core Data 本地存储
  - 本地缓存机制
  - 离线数据处理
  - 数据同步队列

- **状态管理**
  - 计划执行状态
  - 用户操作状态
  - 网络连接状态
  - 数据同步状态

- **本地业务逻辑**
  - 计划时间冲突检测
  - 拖拽时的实时验证
  - 表单数据验证
  - 本地通知管理

- **网络通信**
  - RESTful API 调用
  - WebSocket 实时通信
  - 数据序列化/反序列化
  - 错误处理和重试机制

### 8.2 后端服务职责
- **数据持久化**
  - 用户数据管理
  - 计划模板存储
  - 计划实例记录
  - 执行历史记录
  - 统计数据存储

- **业务逻辑处理**
  - 用户认证授权
  - 数据访问控制
  - 计划智能优化
  - 效率分析算法
  - 团队协作逻辑

- **API 接口**
  - RESTful API 设计
  - 接口版本控制
  - 接口文档维护
  - 接口性能优化

- **实时通信服务**
  - WebSocket 服务
  - 消息推送系统
  - 在线状态管理
  - 实时数据同步

- **AI 分析服务**
  - 用户习惯学习
  - 计划优化建议
  - 效率预测模型
  - 异常行为检测

- **安全机制**
  - 数据加密存储
  - 通信加密
  - 访问权限控制
  - 敏感数据脱敏

### 8.3 通信接口
- **基础接口**
  - 用户认证相关
  - 计划模板 CRUD
  - 计划实例 CRUD
  - 执行记录上报

- **数据同步接口**
  - 增量数据同步
  - 全量数据同步
  - 冲突解决策略
  - 离线数据处理

- **统计分析接口**
  - 效率数据查询
  - 统计报表生成
  - 团队数据聚合
  - 个性化建议获取

- **实时通信**
  - 计划状态同步
  - 团队协作消息
  - 系统通知推送
  - 在线状态更新

### 8.4 数据同步策略
- **本地优先**
  - 优先保存本地数据
  - 异步同步到服务器
  - 确保离线可用
  - 冲突时以服务器为准

- **定时同步**
  - 周期性数据同步
  - 增量数据更新
  - 网络恢复自动同步
  - 后台同步机制

- **实时同步**
  - WebSocket 保持连接
  - 状态实时更新
  - 多设备数据同步
  - 协作数据实时共享

