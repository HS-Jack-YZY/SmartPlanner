# SmartPlanner V1.0 第一轮迭代需求

## 1. 用户需求场景
### 1.1 计划区间管理
- 用户可以创建计划区间
  - 设置区间名称
  - 设置开始和结束时间
- 用户可以将计划区间拖拽到日历视图中
  - 支持拖拽交互
  - 显示区间时间范围
  - 可视化区间边界

### 1.2 计划创建
- 用户可以创建新计划，包含以下属性：
  - 计划名称（必填）
  - 重复设置（可选）
    - 无重复/每天/每周/每月
  - 提醒设置（可选）
    - 开启/关闭提醒
    - 提醒时间点
  - 时间设置（必填）
    - 开始时间
    - 结束时间

### 1.3 计划分配
- 用户可以将计划拖拽到计划区间内
  - 支持拖拽交互
  - 显示计划时间段
  - 计划与区间的视觉关联

## 2. 开发步骤建议

### 第一阶段：基础架构搭建（1周）

#### 1. 项目文件结构说明
项目采用模块化的文件组织方式，主要包含以下目录：

##### 1.1 核心模块目录
- **Models目录**：存放所有数据模型相关文件
  - 计划区间模型
  - 计划模型
  - 枚举类型（重复选项、提醒类型等）

- **Views目录**：存放所有视图相关文件
  - 日历相关视图（主日历、时间轴、网格视图等）
  - 计划相关视图（区间视图、计划视图）
  - 表单相关视图（创建区间表单、创建计划表单）

- **ViewModels目录**：存放视图模型文件
  - 日历视图模型
  - 计划视图模型

- **Services目录**：存放服务类文件
  - 数据管理服务
  - 通知管理服务

- **Utilities目录**：存放工具类文件
  - 扩展方法
  - 常量定义

#### 2. CoreData数据模型设计

##### 2.1 计划区间(PlanningZone)实体属性
- **基本信息**
  - 唯一标识符
  - 区间名称
  - 开始时间
  - 结束时间
  - 创建时间
  - 更新时间

- **显示相关**
  - 颜色值
  - 显示位置序号

- **关联关系**
  - 包含的计划列表（一对多关系）
  - 区间类型（工作/休息/运动等）
  - 优先级（高/中/低）
  - 标签列表（可自定义标签）
  - 备注信息

##### 2.2 计划(Plan)实体属性
- **基本信息**
  - 唯一标识符
  - 计划标题
  - 计划描述
  - 开始时间
  - 结束时间
  - 创建时间
  - 更新时间

- **重复设置**
  - 重复类型（无重复/每天/每周/每月）
  - 重复结束日期
  - 重复次数

- **提醒设置**
  - 是否启用提醒
  - 提醒时间
  - 提醒类型

- **关联关系**
  - 所属计划区间（多对一关系）

#### 3. 数据管理服务功能
- 计划区间的增删改查操作
- 计划的增删改查操作
- 数据持久化处理
- 数据一致性维护
- 错误处理机制

#### 4. 开发注意事项

##### 4.1 数据模型设计原则
- 使用唯一标识符确保数据唯一性
- 记录创建和更新时间便于数据同步
- 合理使用可选值处理非必需属性
- 明确定义实体间的关系

##### 4.2 架构设计原则
- 采用MVVM架构模式
- 确保各模块职责单一
- 保持代码的可测试性
- 预留功能扩展空间

##### 4.3 开发优先级
1. 完成数据模型设计
2. 实现基础数据服务
3. 搭建基础UI框架
4. 实现页面导航逻辑

##### 4.4 代码规范要求
- 统一的命名规范
- 完善的注释文档
- 规范的代码格式
- 完整的错误处理

### 第二阶段：日历视图开发（1周）
1. 实现日历基础视图
   - 时间轴显示
   - 日期切换
   - 网格布局
2. 开发拖拽系统
   - 拖拽手势识别
   - 拖拽目标区域
   - 拖拽动画效果

### 第三阶段：计划管理功能（1周）
1. 计划区间功能
   - 区间创建界面
   - 区间数据管理
   - 区间拖拽交互
2. 计划创建功能
   - 创建表单界面
   - 表单数据验证
   - 数据持久化

### 第四阶段：整合与优化（1周）
1. 功能整合
   - 计划拖拽到区间
   - 数据同步机制
   - 界面状态管理
2. 测试与优化
   - 功能测试
   - 性能优化
   - Bug修复

## 3. 技术要点

### 3.1 核心组件
- 日历视图组件（CalendarView）
- 计划区间组件（PlanningZoneView）
- 计划创建表单（PlanCreationForm）
- 拖拽管理器（DragDropManager）

### 3.2 数据模型
- Task（任务模型）
  - 基本属性：id, 标题, 描述, 截止日期
  - 状态属性：优先级, 完成状态
  - 关联关系：标签, 提醒

### 3.3 关键功能
- SwiftUI拖拽系统实现
- CoreData数据管理
- 时间处理工具
- 状态管理系统

## 4. 注意事项
1. 优先实现核心交互流程
2. 确保拖拽体验流畅
3. 注意数据一致性
4. 保持代码可扩展性